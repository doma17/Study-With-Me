# Web Server와 WAS

## 웹 서버 (Web Server)

웹 서버는 클라이언트(브라우저 등)의 요청에 대해 **정적인 콘텐츠**를 제공하는 서버입니다.

여기서 정적 콘텐츠란 빌드(Build) 과정을 통해 생성된 `index.html`, `main.js`, `style.css` 파일이나, `logo.png`, `font.woff` 처럼 미리 저장되어 있어 **누가 요청하든 동일하게 제공되는 파일**을 의미합니다.

- 클라이언트가 브라우저에서 URL을 입력하면, 웹 서버는 해당 경로의 파일을 찾아서 HTTP 프로토콜로 전달합니다.
- 모든 사용자에게 동일한 콘텐츠를 제공합니다.
- 동적 요청은 직접 처리하지 못하고, 처리해야 할 경우 하위의 WAS 또는 컨테이너에 요청을 넘겨서 처리결과를 받아 전달하는 중개 역할을 합니다.
- 대표적 예시: Nginx, Apache

프론트엔드 관점에서 **웹 서버**는 프론트가 빌드한 정적 파일(HTML, JS, CSS)을 사용자에게 빠르고 안전하게 전달하는 **배포 담당자**입니다.

사용자의 첫 페이지 로딩 속도(FCP)와 직결되기에 매우 중요합니다.

- **성능 최적화 (Caching)**
  정적 자원은 자주 바뀌지 않습니다.
  웹 서버에서 `Cache-Control` 헤더를 적절히 설정하여 브라우저가 한 번 받은 리소스를 재사용하도록 유도합니다.
- **CDN 연동**
  웹 서버를 'Origin' 서버로 두고 CDN(Content Delivery Network)을 연동합니다.
  이를 통해 전 세계 어디서든 사용자와 가장 가까운 서버에서 JS, CSS 파일을 빠르게 다운로드할 수 있게 합니다.
- **HTTPS 설정**
  웹 서버 단에서 SSL/TLS 인증서를 적용하여, 서비스가 안전하게 `https`로 통신하도록 보장합니다.
- **라우팅 중개 (Proxy)**
  `api.myservice.com` 같은 API 요청이 들어왔을 때, 이 요청을 실제 로직이 실행될 내부 WAS로 안전하게 전달(Reverse Proxy)하는 관문 역할도 수행합니다.

<br/>

## 웹 어플리케이션 서버 (WAS)

웹 어플리케이션 서버는 **동적인 컨텐츠**를 생성하고 제공하는 서버입니다.

동적 컨텐츠란 사용자의 요청에 따라 서버가 내부 로직, 데이터베이스 조회 등을 수행해 만들어 내는 맞춤형 결과물입니다.

**WAS**는 사용자의 요청에 따라 데이터를 가공하거나 HTML을 동적으로 생성하는 **'백엔드 로직'** 그 자체이며, 우리에겐 주로 **API 서버**로 인식됩니다.

- WAS는 동적 요청을 받아 처리하고, 그 결과를 웹 서버에 전달합니다.
- WAS는 Java의 서블릿(Servlet), JSP 기술을 주로 활용하며, 비즈니스 로직과 세션 관리, 트랜잭션 처리 등 다양한 서버 사이드 기능을 수행합니다.
- 대표적인 WAS로는 Tomcat, Jetty 등이 있으며, Java 기반 웹 서비스에서 많이 사용됩니다.

프론트엔드에게 WAS는 대부분 **'API 서버'** 또는 **'SSR 서버'**의 형태로 나타납니다.

**1. API 서버 (데이터 제공자)**

가장 일반적인 협업 형태입니다.

클라이언트 사이드 렌더링(CSR) 애플리케이션(React, Vue 등)은 정적 파일(껍데기)만 웹 서버로부터 받은 뒤, 필요한 데이터는 `fetch`나 `axios`를 통해 WAS(API 서버)에 요청합니다.

- **주요 상호작용:** WAS는 프론트에게 **JSON** 형식의 데이터를 제공합니다.
- **주요 관심사:**
  - **API 명세(Specification):** 요청/응답 데이터 구조는 어떻게 되는가?
  - **인증 방식:** 로그인(세션/쿠키, JWT, OAuth)은 어떻게 처리하는가?
  - **상태 코드:** 성공(2xx), 실패(4xx, 5xx) 시 어떤 상태 코드를 반환하는가?

**2. SSR 서버 (HTML 생성자)**

- SSR(Server Side Rendering)을 채택한 경우, WAS는 데이터뿐만 아니라 **HTML 뷰 자체를 동적으로 생성**합니다.
- **주요 상호작용:** 사용자가 페이지를 요청하면, WAS가 서버 환경에서 React/Vue 컴포넌트를 렌더링하고 데이터까지 채운 **완성된 HTML**을 클라이언트에 전달합니다.
- **주요 관심사:**
  - **초기 로딩 속도 (UX와 SEO)**
    서버 사이드 렌더링(SSR)을 사용하는 가장 큰 이유 중 하나입니다.
    React나 Vue 같은 SPA(Single Page Application)는 기본적으로 CSR 방식입니다.\
    사용자가 접속하면 서버는 거의 비어있는 `index.html` 파일과 거대한 `app.js` 파일을 보냅니다.
    이후 JavaScript가 실행되어 React/Vue가 DOM을 그리기 시작하고, 필요한 데이터를 API 서버에 추가로 요청(fetch)합니다.
    데이터가 도착하면 비로소 완성된 화면을 렌더링합니다.
    이 모든 과정이 끝나기 전까지 사용자는 의미 있는 콘텐츠(FCP: First Contentful Paint)를 볼 수 없습니다.
    SSR은 이를 서버에서 미리 처리함으로써 문제를 해결합니다.
  - **Hydration**
    서버는 사용자의 요청에 "완벽하게 조립된 레고 장난감(정적 HTML)"을 보냅니다.
    이 장난감은 보기엔 완벽하지만, 움직이거나 버튼을 누를 수 없는 '정지된' 상태입니다.
    하이드레이션은 이 정지된 장난감에 '배터리(JavaScript)'를 넣어, 버튼을 누르면 불이 들어오고 움직일 수 있게(Interactive) 생명을 불어넣는 과정입니다.
    - **Time to Interactive (TTI) 지연**
      사용자는 FCP(콘텐츠 표시)가 빨라서 페이지가 다 로드되었다고 생각하지만, Hydration이 완료되기 전까지는 버튼을 클릭해도 아무 반응이 없을 수 있습니다. (JS가 아직 붙지 않았기 때문)
      이 '보고는 있지만 만질 수 없는' 시간을 최소화하는 것이 중요합니다.
  - **Next.js, Nuxt.js** 같은 프레임워크는 개발 환경에서는 웹 서버와 WAS의 기능을 통합하여 제공하지만, 프로덕션 환경에서는 이들의 역할(정적 파일 서빙, SSR 처리)이 분리되어 동작합니다.

<br/>

## API 서버

API 서버는 데이터 통신에 특화된 서버로, 주로 JSON, XML 같은 데이터를 클라이언트에 제공합니다.

- 일반적인 웹 페이지 제공보다는 모바일 앱, SPA 등에서 백엔드 데이터 소비용으로 활용됩니다.
- 보안을 위해 API 키, OAuth 등 인증방식을 엄격하게 관리합니다.
- 프론트엔드는 API 서버와 통신해 필요한 데이터를 받아 화면을 구성하거나 상태를 갱신합니다.

<br/>

## 왜 웹 서버와 WAS를 분리할까?

- **성능 최적화**
  정적 자원은 빠른 전달이 중요하므로 전용 웹 서버가 처리하고, 복잡한 비즈니스 로직은 WAS에 맡겨 부하를 분산시킵니다.
- **보안 강화**
  SSL/TLS 암호화 등 보안 처리를 웹 서버에 집중시키고, WAS는 애플리케이션 로직과 데이터 처리에 집중할 수 있습니다.
- **확장성 보장**
  여러 WAS 인스턴스를 분리 배치해 로드 밸런싱하고, 장애 발생 시 무중단 서비스를 가능케 합니다.

<br/>

## 정리

| **구분**        | **웹 서버**                        | **웹 어플리케이션 서버 (WAS)**             | API 서버                                |
| --------------- | ---------------------------------- | ------------------------------------------ | --------------------------------------- |
| 역할            | 정적 콘텐츠 제공                   | 동적 콘텐츠 처리 및 제공                   | 데이터 제공 및 소비                     |
| 주요 처리 대상  | HTML, CSS, 이미지, JS 등 정적 파일 | JSP, Servlet, 서버 사이드 스크립트, API    | JSON, XML 등데이터를 포함한 Body 컨텐츠 |
| 성능 최적화     | 정적 자원 캐싱, CDN 연동 등        | 세션 관리, 트랜잭션, 비즈니스 로직         | API 요청 최적화, 데이터 전송 최소화     |
| 대표 소프트웨어 | Nginx, Apache                      | Tomcat, Jetty                              | RESTful API 서버 등                     |
| 보안            | SSL/TLS 처리                       | 인증/권한처리, 세션 유지                   | API 키, OAuth 등을 통한 보안            |
| 협업 포인트     | 자원 배포, CDN, HTTPS 설정 등      | API 응답, 서버 렌더링, 세션/쿠키 관리 이해 | API 설계, 버전 관리, 인증 및 권한 정책  |

<br/>
<br/>

> 참고
>
> - https://soso-hyeon.tistory.com/81
