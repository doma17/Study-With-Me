## SQL 연산자: UNION 과 DISTINCT

### 1\. UNION (합집합 연산자)

![](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Ft1.daumcdn.net%2Fcfile%2Ftistory%2F99934B335A2D099E12)

`UNION`은 여러 개의 `SELECT` 문의 결과를 하나의 결과 집합(Result Set)으로 결합하는 연산자입니다.

#### 주요 특징

- **결합 조건**: `UNION`으로 연결되는 모든 `SELECT` 문은 **컬럼의 개수, 데이터 타입, 순서가 모두 동일해야** 합니다.
- **중복 자동 제거**: `UNION`은 기본적으로 결과 집합에서 **중복되는 행을 자동으로 제거**합니다. 이는 `DISTINCT` 연산이 포함된 것과 같습니다.
- **`UNION ALL`**: 중복 제거 과정 없이 모든 결과를 그대로 합치고 싶을 때는 `UNION ALL`을 사용합니다. 중복을 제거하는 작업이 없으므로 `UNION`보다 성능이 더 빠릅니다.

#### 활용 예시: `FULL OUTER JOIN` 구현

MySQL과 같이 `FULL OUTER JOIN`을 직접 지원하지 않는 데이터베이스에서 `LEFT JOIN`과 `RIGHT JOIN`의 결과를 `UNION`으로 합쳐 동일한 기능을 구현할 수 있습니다.

```sql
-- LEFT JOIN 결과 (왼쪽 테이블의 모든 데이터 포함)
(SELECT * FROM EMP E LEFT JOIN DEPT D ON E.DEPTNO = D.DEPTNO)
UNION
-- RIGHT JOIN 결과 (오른쪽 테이블의 모든 데이터 포함)
(SELECT * FROM EMP E RIGHT JOIN DEPT D ON E.DEPTNO = D.DEPTNO);
```

> 이 쿼리는 두 조인의 결과를 합치면서 중복되는 행(INNER JOIN에 해당하는 부분)을 한 번만 보여주므로 `FULL OUTER JOIN`과 동일한 결과를 반환합니다.

-----

### 2\. DISTINCT (중복 제거)

`DISTINCT`는 `SELECT` 절에서 사용하여 결과 집합의 특정 컬럼에서 중복된 값을 제거하고 고유한(Unique) 값만 보여주는 키워드입니다.

#### 성능 고려사항

- 단순히 `SELECT DISTINCT`를 사용하는 것은 편리하지만, **쿼리가 복잡해지거나 데이터 양이 많아지면 성능이 저하**될 수 있습니다. `JOIN` 이후에 중복을 제거하면 처리할 데이터가 많기 때문입니다.
- 성능 개선을 위해서는 **`JOIN`을 수행하기 전에 서브쿼리(Subquery)를 사용하여 미리 중복을 제거**하는 것이 좋습니다.

#### 사용 방법

**1. 간단한 사용법**

```sql
SELECT DISTINCT E.DEPTNO, D.DEPTNO
FROM EMP E
LEFT JOIN DEPT D
ON E.DEPTNO = D.DEPTNO;
```

**2. 성능 개선을 위한 서브쿼리 활용**
`JOIN`을 할 테이블의 중복을 서브쿼리를 통해 먼저 제거한 후, 그 결과와 `JOIN`을 수행합니다.

```sql
SELECT C.NAME, C.COUNTRYCODE
FROM CITY C
LEFT JOIN (
    -- JOIN 전에 COUNTRY 테이블의 중복을 미리 제거
    SELECT DISTINCT NAME, CODE
    FROM COUNTRY
) AS CO
ON C.COUNTRYCODE = CO.CODE;
```